<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <style type="text/css">
    body { margin: 0; padding: 8px; background-color: #21222c; color: #f8f8f2; font-family: Georgia, serif; font-size: 14px; }
    form { margin: 0; }
    input[type="text"] { width: 80%; padding: 6px 8px; background-color: #282a36; color: #f8f8f2; border: 1px solid #44475a; }
    input[type="submit"] { padding: 6px 14px; margin-left: 8px; background-color: #bd93f9; color: #282a36; border: 0; font-weight: bold; cursor: pointer; }
  </style>
</head>
<body>
  <form name="chatform" onsubmit="return envia();">
    <input type="text" name="msg" placeholder="Digite sua mensagem...">
    <input type="submit" value="Enviar">
  </form>
  <script type="text/javascript">
    function duasCasas(n) {
      return n < 10 ? '0' + n : '' + n;
    }
    function envia() {
      var f = document.chatform;
      var t = f.msg.value;
      if (!t || t.length === 0) return false;
      var main = parent.frames['main'];
      if (!main || !main.document) return false;
      var el = main.document.getElementById('messages');
      if (!el) return false;
      var agora = new Date();
      var hora = duasCasas(agora.getHours()) + ':' + duasCasas(agora.getMinutes());
      var p = main.document.createElement('p');
      p.className = 'msg you';
      p.innerHTML = '<span class="user">Voce</span><span class="time">' + hora + '</span><br>' + escapeHtml(t);
      el.appendChild(p);
      el.scrollTop = el.scrollHeight;
      f.msg.value = '';
      return false;
    }
    function escapeHtml(s) {
      return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
    }
  </script>
</body>
</html>
